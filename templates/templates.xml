<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="assets_backend" name="Generic Request Assets" inherit_id="web.assets_frontend">
        <xpath expr="." position="inside">
            <link rel="stylesheet"
                  type="text/less"
                  href='/bureaucrat_knowledge_website/static/src/less/knowledge_base_website.less'/>
        </xpath>
    </template>
        
    <template id="knowledge_category_navigation">
        <div class="row mt16">
            <div class="oe_structure col-sm-12"/>
            <div class="col-xs-12 col-sm 12 col-md-6">
                <ol class="breadcrumb">
                    <li><a href="/"><i class="fa fa-home"/></a></li>
                        <li><a href="/knowledge/">Bureaucrat Knowledge</a></li>
                        <t t-foreach="parents" t-as="p">
                            <li><a t-attf-href="/knowledge/{{ slug(p) }}"><t t-esc="p.name"/></a></li>
                        </t>
                </ol>
            </div>
            <div class="oe_structure col-sm-12"/>
        </div>
    </template>

    <template id="documents_list" name="Render documents">
        <t t-if="docs_list != None">
            <ul>
                <t t-foreach="docs_list" t-as="child_doc">
                    <p>
                        <t t-if="category != None">
                            <t t-set="category_id" t-value="category.id"/>
                        </t>
                        <t t-else="">
                            <t t-set="category_id" t-value="child_doc.category_id.id"/>
                        </t>
                        <li class="child_doc">
                            <i class="fa fa-file mr4"/>
                            <a t-attf-href="/knowledge/doc/{{ slug(child_doc) }}">
                                <t t-esc="child_doc.name"/>
                            </a>
                        </li>
                    </p>
                </t>
            </ul>
        </t>
    </template>

    <template id="categories_list" name="Render Page">
        <t t-if="categories != None">
            <ul>
                <t t-foreach="categories" t-as="category">
                    <li t-attf-class="{{ 'parent_categ' if h == 1 else 'child_categ' }}">
                        <i class="fa fa-folder mr4"/>
                        <a t-attf-href="/knowledge/{{ '' if h == 1 and category.parent_id.id == False else slug(category) }}">
                            <t t-esc="category.name"/>
                        </a>
                        <t t-if="category.child_ids != None">
                            <t t-set="h" t-value="0"/>
                            <t t-set="categories" t-value="category.child_ids"/>
                            <t t-call="bureaucrat_knowledge_website.categories_list"/>
                        </t>
                        <t t-if="category.document_ids != None">
                            <t t-set="docs_list" t-value="category.document_ids"/>
                            <t t-call="bureaucrat_knowledge_website.documents_list"/>
                        </t>
                    </li>
                </t>
            </ul>
        </t>
    </template>

    <template id="knowledge_main" name="Bureaucrat knowledge main">
        <t t-call="website.layout">
            <t t-set="title">Categories</t>
            <div class="oe_structure">
                <div class="container">
                    <t t-call="bureaucrat_knowledge_website.knowledge_category_navigation"/>
                    <t t-set="h" t-value="1"/>
                    <t t-call="bureaucrat_knowledge_website.categories_list"/>
                    <t t-if="documents != None">
                        <t t-set="docs_list" t-value="documents"/>
                        <t t-call="bureaucrat_knowledge_website.documents_list"/>
                    </t>
                </div>
            </div>
        </t>
    </template>

    <template id="knowledge_document" name="Bureaucrat knowledge document">
        <t t-call="website.layout">
            <t t-set="title"><t t-esc="doc.name"/></t>
            <div class="oe_structure">
                <div class="container">
                    <t t-call="bureaucrat_knowledge_website.knowledge_category_navigation"/>
                    <div class="container">
                        <div id="document-text"
                            t-raw="doc.document_body">
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>
</odoo>
